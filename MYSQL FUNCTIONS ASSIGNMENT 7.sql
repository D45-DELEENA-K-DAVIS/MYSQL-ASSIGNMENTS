-- QUERYING DATA
-- CREATING DATABASE
CREATE DATABASE INFORMATIONS;
USE INFORMATIONS;

-- CREATING TABLE 1
CREATE TABLE COUNTRY(
ID INT PRIMARY KEY,
COUNTRY_NAME VARCHAR(50),
POPULATION INT NOT NULL,
AREA FLOAT
);

-- CREATING TABLE 2
CREATE TABLE PERSONS(
ID INT ,
FNAME VARCHAR(50),
LNAME VARCHAR(50) ,
POPULATION INT NOT NULL,
RATING FLOAT CHECK(RATING IN(1.0,1.5,2.0,2.5,3.0,3.5,4.0,4.5,5.0)),
COUNTRY_ID  INT ,
COUNTRY_NAME VARCHAR(50)
);

-- INSERTING DATA TO TABLE 1
INSERT INTO COUNTRY (ID,COUNTRY_NAME ,POPULATION ,AREA)
VALUES
(1011,'INDIA',100000,77445.2),
(1012,'CHINA',400000,22458.9),
(1013,'US',50000,25658.5),
(1014,'CANADA',20000,12356.4),
(1015,'UK',1000000,9980.85),
(1016,'AUSTRALIA',1500000,69844.2),
(1017,'GERMANY',12000,85111.1),
(1018,'IRELAND',2000000,36581.1),
(1019,'POLAND',150000,13597.0),
(1020,'EUROPE',700000,5555.5);
SELECT *FROM COUNTRY;

-- INSERTING DATA TO TABLE 2
INSERT INTO PERSONS(ID,FNAME,LNAME,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME)
VALUES
(1,'ROCKY','MANTIN',100000,'3.5',1011,'INDIA'),
(2,'ZAMBIN','VIRNAN',400000,'2.0',1012,'CHINA'),
(3,'RAYAN','YOKUL',500000,'3.0',1013,'US'),
(4,'MANVITHA','PRAKSHITH',2000000,'3.0',1014,'CANADA');
INSERT INTO PERSONS(ID,FNAME,LNAME,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME)
VALUE
(5,'ALASKA','ROSE',1000000,'1.0',1015,'OSLO');
INSERT INTO PERSONS(ID,FNAME,LNAME,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME)
VALUES
(6,'ABBERLLINA','ASHIQ',1500000,'1.5',1016,'AUSTRALIA'),
(7,'VINIYA','VINAY',1200000,'4.5',1017,'GERMANY'),
(8,'DELBEL','DALI',2000000,'5.0',1018,'UK');
INSERT INTO PERSONS(ID,FNAME,LNAME,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME)
VALUES
(9,'BHOOMI','BODTHI',150000,'3.5',1019,'IRELAND'),
(10,'THONKHOI','CHOKNE',700000,'2.5',1020,'BRAZIL');
SELECT *FROM PERSONS;

# adding a column DOB in persons table
alter table PERSONS add DOB date ;
desc persons;

-- enter the data
INSERT INTO PERSONS(ID,FNAME,LNAME,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME,DOB)
VALUES
(1,'ROCKY','MANTIN',100000,'3.5',1011,'INDIA','2000-12-12'),
(2,'ZAMBIN','VIRNAN',400000,'2.0',1012,'CHINA','1999-07-10'),
(3,'RAYAN','YOKUL',500000,'3.0',1013,'US','1990-04-11'),
(4,'MANVITHA','PRAKSHITH',2000000,'3.0',1014,'CANADA','1998-08-04'),
(5,'ALASKA','ROSE',1000000,'1.0',1015,'OSLO','1994-11-12'),
(6,'ABBERLLINA','ASHIQ',1500000,'1.5',1016,'AUSTRALIA','2000-05-22'),
(7,'VINIYA','VINAY',1200000,'4.5',1017,'GERMANY','1996-01-30'),
(8,'DELBEL','DALI',2000000,'5.0',1018,'UK','1991-10-24'),
(9,'BHOOMI','BODTHI',150000,'3.5',1019,'IRELAND','1999-10-25'),
(10,'THONKHOI','CHOKNE',700000,'2.5',1020,'BRAZIL','1993-12-29');
SELECT *FROM PERSONS;


-- USER DEFINED FUNCTIONS
-- CREATING A USER DEFINED FUNCTION 
# change the default delimiter

delimiter //
create function CalculateAge(DOB date)
returns int
deterministic
Begin
declare Age int;
set Age=timestampdiff(YEAR,DOB,CURDATE());
return Age;
end //
delimiter ;

# using the UDF
select DOB, CalculateAge(DOB) as Age from PERSONS;



-- query to fetch the age of all person
select FNAME,LNAME,CalculateAge(DOB) as Age from PERSONS;



-- length of each country name in the country table
-- USER DEFINED FUNCTIONS
-- CREATING A USER DEFINED FUNCTION 
# change the default delimiter

delimiter //
create function Countryname_length(COUNTRY_NAME varchar(50))
returns int
deterministic
Begin
return length(COUNTRY_NAME);
end //
delimiter ;

# using the UDF
select COUNTRY_NAME, Countryname_length(COUNTRY_NAME) as country_length from COUNTRY;



-- extract the first three characters of country name
select COUNTRY_NAME,left(COUNTRY_NAME,3) as LEFT_THREE_COUNTRY_NAME from COUNTRY;



-- covert all the country names to uppercase & lowercase in the country table
select COUNTRY_NAME,upper(COUNTRY_NAME) AS UPPERCASE,lower(COUNTRY_NAME) AS LOWERCASE FROM COUNTRY;


